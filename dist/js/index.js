var dataList,len,control,timer,i,root=window.player,audio=root.AudioManager;function getData(t){$.ajax({type:"GET",url:t,success:function(t){len=t.length,control=new root.controlIndex(len),dataList=t,bindEvent(),bindTouch(),changeLoad(0)},error:function(){}})}function bindEvent(){$(".prev").on("click",function(){changeLoad(i=control.prev()),root.pro.start(0),"pause"==audio.status&&root.pro.stop()}),$(".next").on("click",function(){changeLoad(i=control.next()),root.pro.start(0),"pause"==audio.status&&root.pro.stop()}),$(".play").on("click",function(){"pause"==audio.status?(audio.play(),root.pro.start(),rotated($(".img-box").attr("data-deg"))):(audio.pause(),root.pro.stop(),clearInterval(timer)),$(".play").toggleClass("playing")}),$(".like").on("click",function(){dataList[control.index].isLike?dataList[control.index].isLike=!1:dataList[control.index].isLike=!0,root.render(dataList[control.index])}),$("body").on("click",function(){$(".list-wrap").css({display:"none"})}),$(".list").on("click",function(){return $(".list-wrap").css({display:"block"}),root.list.shwoList(dataList),!1})}function changeLoad(t){clearInterval(timer),$(".img-box").attr("data-deg",0),$(".img-box").css({transform:"rotateZ(0deg)",transition:"none"}),audio.getAudio(dataList[t].audio),root.render(dataList[t]),root.pro.renderAllTime(dataList[t].duration),"play"==audio.status&&(audio.play(),rotated())}function bindTouch(){var t=$(".pro-bottom").offset(),o=t.left,a=t.width;$(".spot").on("touchstart",function(){root.pro.stop()}).on("touchmove",function(t){t=(t.changedTouches[0].clientX-o)/a;0<=t&&t<=1&&root.pro.update(t)}).on("touchend",function(t){t=(t.changedTouches[0].clientX-o)/a;0<=t&&t<=1&&(root.pro.start(t),t=t*dataList[control.index].duration,audio.playTo(t),audio.play(),audio.status="paly",$(".play").addClass("playing"))})}function rotated(t){t=+(t=t||0),clearInterval(timer),timer=setInterval(function(){t+=1,$(".img-box").attr("data-deg",t),$(".img-box").css({transform:"rotateZ("+t+"deg)",transition:"all 1s ease-out"})},100)}getData("../mock/data.json");